# Модуль оплати AIFO для DataLifeEngine

Модуль оплати AIFO призначений для приймання платежів через платіжну систему AIFO в системі керування контентом DataLifeEngine. Модуль інтегрується з білінговим модулем DataLifeEngine та забезпечує формування платіжних запитів, обробку callback-повідомлень і перевірку підпису платежів.

Для коректної роботи модуля необхідно використовувати DataLifeEngine версії 13.x або новішої, PHP версії 7.0 або новішої, а також встановлений та активований модуль Billing.

Перед встановленням модуля необхідно завантажити його файли та розмістити їх у відповідних каталогах. Папку модуля aifo слід скопіювати до каталогу /engine/modules/billing/payments/. За потреби іконку модуля необхідно розмістити за шляхом /templates/Default/billing/icons/aifo.png. Після копіювання перевірте, що структура каталогу /engine/modules/billing/payments/aifo/ містить файли adm.settings.php та info.ini.

Після встановлення файлів виконайте налаштування модуля в адміністративній панелі DataLifeEngine. Для цього перейдіть у розділ Billing, відкрийте список платіжних систем, знайдіть модуль AIFO та перейдіть до його налаштувань. У параметрах модуля необхідно вказати ідентифікатор магазину (shop_id) та секретний ключ (secret_key), отримані в особистому кабінеті платіжної системи AIFO в розділі налаштувань магазину. Секретний ключ зберігається в зашифрованому вигляді.

У параметрі типу підпису (signature_type) необхідно вибрати алгоритм хешування, що використовується в особистому кабінеті AIFO. Підтримуються такі значення: 1 — MD5, 2 — SHA256, 3 — SHA1, 4 — RIPEMD160, 5 — SHA384, 6 — SHA512. Значення параметра повинно повністю відповідати налаштуванням платіжної системи AIFO.

У параметрі URL сервісу AIFO вказується адреса платіжного сервісу. За замовчуванням використовується https://aifo.pro. За необхідності може бути вказаний production URL, наданий платіжною системою. Додатково може бути налаштований IP-фільтр (ip_filter), у якому вказується список довірених IP-адрес через кому. Якщо параметр не заповнений, перевірка IP-адрес не виконується.

Для отримання повідомлень про результати платежів у налаштуваннях модуля необхідно вказати callback URL у форматі http://ваш-домен/engine/modules/billing/payments/aifo/callback.php, де ваш-домен — доменне ім’я сайту з установленим DataLifeEngine. Рекомендується використовувати захищене з’єднання HTTPS та забезпечити доступність зазначеного URL з мережі Інтернет.

Формування підпису платіжного запиту виконується за формулою hash(shop_id:amount:secret_key:order_id), де shop_id — ідентифікатор магазину, amount — сума платежу, secret_key — секретний ключ, order_id — ідентифікатор замовлення. Тип функції хешування визначається значенням параметра signature_type.

Під час обробки callback-повідомлень виконується перевірка підпису за формулою hash(shop_id:sum:secret_key:invoice), де sum — сума платежу з callback-повідомлення, invoice — ідентифікатор інвойсу. Отриманий підпис порівнюється зі значенням http_auth_signature.

Модуль підтримує всі типи підписів, доступні в платіжній системі AIFO. Тип підпису в налаштуваннях модуля повинен збігатися з типом підпису, зазначеним в особистому кабінеті AIFO. У разі виникнення помилок рекомендується перевірити коректність параметрів, доступність callback URL та права доступу до файлів модуля. Для директорій рекомендується використовувати права доступу 755, для файлів — 644.

Інформація про платіжну систему та технічна підтримка доступні на офіційному сайті https://aifo.pro, у документації https://aifo.pro/docs та через Telegram @aifo_bot.

Версія модуля: AIFO Payment Module for DataLifeEngine v1.0. © 2026 AIFO.PRO.
